<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Room</title>
<style>
    body {
        color: white; /* Set text color to white */
    }
</style>
<link rel="stylesheet" type="text/css" href="style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.3/socket.io.js"></script>
</head>
<body>
<div class="bg-image"></div>
<div class="container">
    <h1>Room Details</h1> <!-- Heading -->

    <div id="roomDetails">
        <p>Room ID: <span id="roomId"></span></p>
        <h2>Players in the Room</h2>
        <ul id="playerList">
            <p><span id="playerName"></span></p>
            <!-- Player list will be dynamically populated here -->
        </ul>
    </div>
</div>
<script>
    let playerName; // Global variable declaration
    let roomId; // Global variable declaration

    const socket = io('http://localhost:3000');

    // Extract room ID and player name from URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    roomId = urlParams.get('roomId');
    playerName = urlParams.get('playerName');
    document.createElement('li').textContent = playerName;

    // Update room details on the screen
    function updateRoomDetails() {
        document.getElementById('roomId').textContent = roomId;
        document.getElementById('playerName').textContent = playerName;
    }

    // Function to update player list on the screen
    function updatePlayerList(players) {
        console.log('Updated player list:', players);

        const playerListElement = document.getElementById('playerList');
        const listItem = document.createElement('li');
        listItem.textContent = player.name; // Assuming player has a name property
        playerListElement.appendChild(listItem);
    }

    // Listen for updatePlayerList event
    socket.on('updatePlayerList', ({ roomId, playerName }) => {
        // Update the player list on the client page
        // For example, append playerName to the player list UI
        updatePlayerList({ name: playerName });
        console.log('Updated player list:', playerName);
    });

    // Listen for roomDetails event
socket.on('roomDetails', ({ roomId, playerName }) => {
    // Update URL parameters
    const queryParams = new URLSearchParams(window.location.search);
    queryParams.set('roomId', roomId);
    queryParams.set('playerName', playerName);
    const newUrl = `${window.location.origin}${window.location.pathname}?${queryParams.toString()}`;
    window.history.pushState({ path: newUrl }, '', newUrl);

    // Update room details on the screen
    updateRoomDetails();
});

    // Update room details when the room is created
    socket.on('roomCreated', (data) => {
        roomId = data.roomId;
        updateRoomDetails();
    });

    // Update room details when the page loads
    updateRoomDetails();
</script>
</body>
</html>
